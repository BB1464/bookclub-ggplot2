<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.4 From the ggplot2 book | ggplot2 Book Club</title>
  <meta name="description" content="This is the product of the R4DS Online Learning Community’s Book Club." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="4.4 From the ggplot2 book | ggplot2 Book Club" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the product of the R4DS Online Learning Community’s Book Club." />
  <meta name="github-repo" content="r4ds/bookclub-ggplot2" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.4 From the ggplot2 book | ggplot2 Book Club" />
  
  <meta name="twitter:description" content="This is the product of the R4DS Online Learning Community’s Book Club." />
  

<meta name="author" content="The R4DS Online Learning Community" />


<meta name="date" content="2021-10-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="quick-intuition-on-collective-geoms.html"/>
<link rel="next" href="statistical-summaries.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ggplot2 with R Book Club</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="book-club-meetings.html"><a href="book-club-meetings.html"><i class="fa fa-check"></i>Book club meetings</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="slide-1-title.html"><a href="slide-1-title.html"><i class="fa fa-check"></i><b>1.1</b> {Slide 1 title}</a></li>
<li class="chapter" data-level="1.2" data-path="meeting-videos.html"><a href="meeting-videos.html"><i class="fa fa-check"></i><b>1.2</b> Meeting Videos</a><ul>
<li class="chapter" data-level="1.2.1" data-path="meeting-videos.html"><a href="meeting-videos.html#cohort-1"><i class="fa fa-check"></i><b>1.2.1</b> Cohort 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="first-steps.html"><a href="first-steps.html"><i class="fa fa-check"></i><b>2</b> First Steps</a><ul>
<li class="chapter" data-level="2.1" data-path="general-housekeeping-items.html"><a href="general-housekeeping-items.html"><i class="fa fa-check"></i><b>2.1</b> General Housekeeping Items</a></li>
<li class="chapter" data-level="2.2" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>2.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.3" data-path="main-data-set.html"><a href="main-data-set.html"><i class="fa fa-check"></i><b>2.3</b> Main data set</a></li>
<li class="chapter" data-level="2.4" data-path="components-of-every-plot.html"><a href="components-of-every-plot.html"><i class="fa fa-check"></i><b>2.4</b> Components of every plot</a></li>
<li class="chapter" data-level="2.5" data-path="a-few-exercises.html"><a href="a-few-exercises.html"><i class="fa fa-check"></i><b>2.5</b> A few exercises</a></li>
<li class="chapter" data-level="2.6" data-path="other-aesthetic-attributes.html"><a href="other-aesthetic-attributes.html"><i class="fa fa-check"></i><b>2.6</b> Other aesthetic attributes</a></li>
<li class="chapter" data-level="2.7" data-path="faceting.html"><a href="faceting.html"><i class="fa fa-check"></i><b>2.7</b> Faceting</a></li>
<li class="chapter" data-level="2.8" data-path="geoms.html"><a href="geoms.html"><i class="fa fa-check"></i><b>2.8</b> Geoms</a></li>
<li class="chapter" data-level="2.9" data-path="modifying-the-axes.html"><a href="modifying-the-axes.html"><i class="fa fa-check"></i><b>2.9</b> Modifying the Axes</a></li>
<li class="chapter" data-level="2.10" data-path="output.html"><a href="output.html"><i class="fa fa-check"></i><b>2.10</b> Output</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="layers.html"><a href="layers.html"><i class="fa fa-check"></i>Layers</a><ul>
<li class="chapter" data-level="2.11" data-path="layers-chapters.html"><a href="layers-chapters.html"><i class="fa fa-check"></i><b>2.11</b> Layers: Chapters</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="individual-geoms.html"><a href="individual-geoms.html"><i class="fa fa-check"></i><b>3</b> Individual Geoms</a><ul>
<li class="chapter" data-level="3.1" data-path="scatterplot.html"><a href="scatterplot.html"><i class="fa fa-check"></i><b>3.1</b> Scatterplot:</a></li>
<li class="chapter" data-level="3.2" data-path="line-plot.html"><a href="line-plot.html"><i class="fa fa-check"></i><b>3.2</b> Line plot:</a></li>
<li class="chapter" data-level="3.3" data-path="histogram.html"><a href="histogram.html"><i class="fa fa-check"></i><b>3.3</b> Histogram:</a></li>
<li class="chapter" data-level="3.4" data-path="bar-chart.html"><a href="bar-chart.html"><i class="fa fa-check"></i><b>3.4</b> Bar chart</a></li>
<li class="chapter" data-level="3.5" data-path="geom_polygon-draws-polygons-which-are-filled-paths..html"><a href="geom_polygon-draws-polygons-which-are-filled-paths..html"><i class="fa fa-check"></i><b>3.5</b> geom_polygon() draws polygons which are filled paths.</a></li>
<li class="chapter" data-level="3.6" data-path="geom_line-connects-points-from-left-to-right..html"><a href="geom_line-connects-points-from-left-to-right..html"><i class="fa fa-check"></i><b>3.6</b> geom_line() connects points from left to right.</a></li>
<li class="chapter" data-level="3.7" data-path="what-low-level-geoms-are-used-to-draw-geom_smooth.html"><a href="what-low-level-geoms-are-used-to-draw-geom_smooth.html"><i class="fa fa-check"></i><b>3.7</b> What low-level geoms are used to draw geom_smooth()?</a></li>
<li class="chapter" data-level="3.8" data-path="what-low-level-geoms-are-used-to-draw-geom_boxplot.html"><a href="what-low-level-geoms-are-used-to-draw-geom_boxplot.html"><i class="fa fa-check"></i><b>3.8</b> What low-level geoms are used to draw geom_boxplot()?</a></li>
<li class="chapter" data-level="3.9" data-path="what-low-level-geoms-are-used-to-draw-geom_violin.html"><a href="what-low-level-geoms-are-used-to-draw-geom_violin.html"><i class="fa fa-check"></i><b>3.9</b> What low-level geoms are used to draw geom_violin()?</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="collective-geoms.html"><a href="collective-geoms.html"><i class="fa fa-check"></i><b>4</b> Collective Geoms</a><ul>
<li class="chapter" data-level="4.1" data-path="general-housekeeping-items-1.html"><a href="general-housekeeping-items-1.html"><i class="fa fa-check"></i><b>4.1</b> General Housekeeping Items</a></li>
<li class="chapter" data-level="4.2" data-path="learning-objectives-1.html"><a href="learning-objectives-1.html"><i class="fa fa-check"></i><b>4.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="4.3" data-path="quick-intuition-on-collective-geoms.html"><a href="quick-intuition-on-collective-geoms.html"><i class="fa fa-check"></i><b>4.3</b> Quick Intuition on Collective Geoms</a></li>
<li class="chapter" data-level="4.4" data-path="from-the-ggplot2-book.html"><a href="from-the-ggplot2-book.html"><i class="fa fa-check"></i><b>4.4</b> From the ggplot2 book</a><ul>
<li class="chapter" data-level="4.4.1" data-path="from-the-ggplot2-book.html"><a href="from-the-ggplot2-book.html#multiple-groups-one-aesthetic"><i class="fa fa-check"></i><b>4.4.1</b> Multiple Groups, One Aesthetic</a></li>
<li class="chapter" data-level="4.4.2" data-path="from-the-ggplot2-book.html"><a href="from-the-ggplot2-book.html#different-groups-on-different-layers"><i class="fa fa-check"></i><b>4.4.2</b> Different Groups on Different Layers</a></li>
<li class="chapter" data-level="4.4.3" data-path="from-the-ggplot2-book.html"><a href="from-the-ggplot2-book.html#overriding-the-default-grouping"><i class="fa fa-check"></i><b>4.4.3</b> Overriding the Default Grouping</a></li>
<li class="chapter" data-level="4.4.4" data-path="from-the-ggplot2-book.html"><a href="from-the-ggplot2-book.html#a-couple-of-exercises"><i class="fa fa-check"></i><b>4.4.4</b> A couple of exercises</a></li>
<li class="chapter" data-level="4.4.5" data-path="from-the-ggplot2-book.html"><a href="from-the-ggplot2-book.html#matching-aesthetics-to-graphic-objects"><i class="fa fa-check"></i><b>4.4.5</b> Matching Aesthetics to Graphic Objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistical-summaries.html"><a href="statistical-summaries.html"><i class="fa fa-check"></i><b>5</b> Statistical Summaries</a><ul>
<li class="chapter" data-level="5.1" data-path="defintions-in-this-chapter.html"><a href="defintions-in-this-chapter.html"><i class="fa fa-check"></i><b>5.1</b> Defintions (in this Chapter)</a></li>
<li class="chapter" data-level="5.2" data-path="revealing-uncertainty.html"><a href="revealing-uncertainty.html"><i class="fa fa-check"></i><b>5.2</b> Revealing Uncertainty</a></li>
<li class="chapter" data-level="5.3" data-path="weighted-data.html"><a href="weighted-data.html"><i class="fa fa-check"></i><b>5.3</b> Weighted Data</a></li>
<li class="chapter" data-level="5.4" data-path="displaying-distributions.html"><a href="displaying-distributions.html"><i class="fa fa-check"></i><b>5.4</b> Displaying distributions</a><ul>
<li class="chapter" data-level="5.4.1" data-path="displaying-distributions.html"><a href="displaying-distributions.html#exercise"><i class="fa fa-check"></i><b>5.4.1</b> Exercise:</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="dealing-with-overplotting.html"><a href="dealing-with-overplotting.html"><i class="fa fa-check"></i><b>5.5</b> Dealing with overplotting</a></li>
<li class="chapter" data-level="5.6" data-path="statistical-summaries-1.html"><a href="statistical-summaries-1.html"><i class="fa fa-check"></i><b>5.6</b> Statistical Summaries</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>6</b> Maps</a><ul>
<li class="chapter" data-level="6.1" data-path="polygon-maps.html"><a href="polygon-maps.html"><i class="fa fa-check"></i><b>6.1</b> Polygon Maps</a></li>
<li class="chapter" data-level="6.2" data-path="simple-features-maps.html"><a href="simple-features-maps.html"><i class="fa fa-check"></i><b>6.2</b> Simple Features Maps</a><ul>
<li class="chapter" data-level="6.2.1" data-path="simple-features-maps.html"><a href="simple-features-maps.html#layered-maps"><i class="fa fa-check"></i><b>6.2.1</b> Layered Maps</a></li>
<li class="chapter" data-level="6.2.2" data-path="simple-features-maps.html"><a href="simple-features-maps.html#labelled-maps"><i class="fa fa-check"></i><b>6.2.2</b> Labelled Maps</a></li>
<li class="chapter" data-level="6.2.3" data-path="simple-features-maps.html"><a href="simple-features-maps.html#adding-other-geoms"><i class="fa fa-check"></i><b>6.2.3</b> Adding Other Geoms</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="map-projections.html"><a href="map-projections.html"><i class="fa fa-check"></i><b>6.3</b> Map Projections</a></li>
<li class="chapter" data-level="6.4" data-path="working-with-sf-data.html"><a href="working-with-sf-data.html"><i class="fa fa-check"></i><b>6.4</b> Working with <code>sf</code> Data</a></li>
<li class="chapter" data-level="6.5" data-path="raster-maps.html"><a href="raster-maps.html"><i class="fa fa-check"></i><b>6.5</b> Raster Maps</a></li>
<li class="chapter" data-level="6.6" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>6.6</b> Data Sources</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ggplot2 Book Club</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="from-the-ggplot2-book" class="section level2">
<h2><span class="header-section-number">4.4</span> From the ggplot2 book</h2>
<ul>
<li>dataset called Oxboys which shows the age and corresponding height of 26 boys from Oxford.</li>
<li>also a longitudinal study.</li>
<li>note that the age is standardized.</li>
</ul>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="from-the-ggplot2-book.html#cb63-1"></a><span class="kw">data</span>(Oxboys, <span class="dt">package =</span> <span class="st">&quot;nlme&quot;</span>)</span>
<span id="cb63-2"><a href="from-the-ggplot2-book.html#cb63-2"></a></span>
<span id="cb63-3"><a href="from-the-ggplot2-book.html#cb63-3"></a><span class="kw">head</span>(Oxboys, <span class="dv">9</span>)</span></code></pre></div>
<pre><code>## Grouped Data: height ~ age | Subject
##   Subject     age height Occasion
## 1       1 -1.0000  140.5        1
## 2       1 -0.7479  143.4        2
## 3       1 -0.4630  144.8        3
## 4       1 -0.1643  147.1        4
## 5       1 -0.0027  147.7        5
## 6       1  0.2466  150.2        6
## 7       1  0.5562  151.7        7
## 8       1  0.7781  153.3        8
## 9       1  0.9945  155.8        9</code></pre>
<div id="multiple-groups-one-aesthetic" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Multiple Groups, One Aesthetic</h3>
<p>As the book says:</p>
<blockquote>
<p>In many situations, you want to separate your data into groups, but render them in the same way. In other words, you want to be able to distinguish individual subjects but not identify them.</p>
</blockquote>
<ul>
<li>sometimes you want the individual geom to be a <strong>group</strong> of observations <em>for the same individual</em>.</li>
<li>you do this by adding a group argument to the aesthetic.</li>
<li>If you’re trying to figure out which variable to use as the grouping variable, fill in the blank “I have multiple observations for each _____”. Or for longitudinal studies, “I want to plot one line over time for each _____”.</li>
</ul>
<details>
<p><summary> What’s the grouping variable for Oxboys?</summary></p>
<p>In the case of Oxboys, we want to plot a line over time for each boy, so <code>Subject</code> is the grouping variable in the aesthetic.</p>
</details>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="from-the-ggplot2-book.html#cb65-1"></a><span class="kw">ggplot</span>(Oxboys, <span class="kw">aes</span>(age, height, <span class="dt">group =</span> Subject)) <span class="op">+</span></span>
<span id="cb65-2"><a href="from-the-ggplot2-book.html#cb65-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb65-3"><a href="from-the-ggplot2-book.html#cb65-3"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="bookclub-ggplot2_01_files/figure-html/04-plot-Oxboys-1.png" width="672" /></p>
<ul>
<li>incorrectly specifying the grouping variable leads to a “characteristic sawtooth appearance”.</li>
</ul>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="from-the-ggplot2-book.html#cb66-1"></a><span class="kw">ggplot</span>(Oxboys, <span class="kw">aes</span>(age, height)) <span class="op">+</span></span>
<span id="cb66-2"><a href="from-the-ggplot2-book.html#cb66-2"></a><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb66-3"><a href="from-the-ggplot2-book.html#cb66-3"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="bookclub-ggplot2_01_files/figure-html/04-sawtooth-1.png" width="672" /></p>
</div>
<div id="different-groups-on-different-layers" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Different Groups on Different Layers</h3>
<p>From the book:</p>
<blockquote>
<p>Sometimes we want to plot summaries that use different levels of aggregation: one layer might display individuals, while another displays an overall summary.</p>
</blockquote>
<ul>
<li>now that we have plotted individual geoms, let’s add a collective geom which is the trendline for all boys together.</li>
</ul>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="from-the-ggplot2-book.html#cb67-1"></a><span class="kw">ggplot</span>(Oxboys, <span class="kw">aes</span>(age, height, <span class="dt">group =</span> Subject)) <span class="op">+</span></span>
<span id="cb67-2"><a href="from-the-ggplot2-book.html#cb67-2"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb67-3"><a href="from-the-ggplot2-book.html#cb67-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb67-4"><a href="from-the-ggplot2-book.html#cb67-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookclub-ggplot2_01_files/figure-html/04-group-at-ggplot-layer-1.png" width="672" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="from-the-ggplot2-book.html#cb69-1"></a><span class="co">#&gt; `geom_smooth()` using formula &#39;y ~ x&#39;</span></span></code></pre></div>
<ul>
<li>something doesn’t look right</li>
<li>expecting a collective geom (one summary line for all subjects), but we got individual geoms again – a trendline for each individual instead of a trendline for all individuals.</li>
<li>“grouping controls both the display of the geoms, and the operation of the stats: one statistical transformation is run for each group”.</li>
<li>we got multiple <code>geom_smooth</code>s because we had the grouping variable in the <code>ggplot</code> line so the grouping flows down to all layers of the plot</li>
<li>to get what we intend, we need to uncouple the grouping variable at the <code>ggplot</code> layer and add it where we want the grouping to happen, namely only at the <code>geom_line</code> layer. That allows the default grouping from the <code>ggplot</code> layer (i.e., no special grouping or just group on the whole dataset) to flow down to the <code>geom_smooth</code> layer.</li>
</ul>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="from-the-ggplot2-book.html#cb70-1"></a><span class="kw">ggplot</span>(Oxboys, <span class="kw">aes</span>(age, height)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb70-2"><a href="from-the-ggplot2-book.html#cb70-2"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> Subject)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb70-3"><a href="from-the-ggplot2-book.html#cb70-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb70-4"><a href="from-the-ggplot2-book.html#cb70-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookclub-ggplot2_01_files/figure-html/04-group-at-line-layer-1.png" width="672" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="from-the-ggplot2-book.html#cb72-1"></a><span class="co">#&gt; `geom_smooth()` using formula &#39;y ~ x&#39;</span></span></code></pre></div>
</div>
<div id="overriding-the-default-grouping" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Overriding the Default Grouping</h3>
<p>In the last exercise, we finally got the grouping right.</p>
<p>This hints at the approach of overriding the default grouping.</p>
<p>By adding the grouping to <code>geom_line</code>, we overrode the default grouping, which was “no special grouping”.</p>
<p>Here’s another example to help illustrate this point a little better. Thanks to <a href="https://www.gl-li.com/2017/08/13/ggplot2-group-overrides-default-grouping/">this</a> blog post.</p>
<p>Subtitles are added to these plots to describe what’s going on.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="from-the-ggplot2-book.html#cb73-1"></a><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(drv, hwy)) <span class="op">+</span></span>
<span id="cb73-2"><a href="from-the-ggplot2-book.html#cb73-2"></a><span class="st">  </span><span class="kw">geom_jitter</span>() <span class="op">+</span></span>
<span id="cb73-3"><a href="from-the-ggplot2-book.html#cb73-3"></a><span class="st">  </span><span class="kw">stat_boxplot</span>(<span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb73-4"><a href="from-the-ggplot2-book.html#cb73-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;stat_boxplot automatically uses the groups set by the categorical variable drv.</span><span class="ch">\n</span><span class="st">Notice that there is only one boxplot for each value of drv.&quot;</span>)</span></code></pre></div>
<p><img src="bookclub-ggplot2_01_files/figure-html/04-overriding-1.png" width="672" /></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="from-the-ggplot2-book.html#cb74-1"></a><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(drv, hwy, <span class="dt">color =</span> <span class="kw">factor</span>(year))) <span class="op">+</span></span>
<span id="cb74-2"><a href="from-the-ggplot2-book.html#cb74-2"></a><span class="st">  </span><span class="kw">geom_jitter</span>() <span class="op">+</span></span>
<span id="cb74-3"><a href="from-the-ggplot2-book.html#cb74-3"></a><span class="st">  </span><span class="kw">stat_boxplot</span>(<span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb74-4"><a href="from-the-ggplot2-book.html#cb74-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;by now adding color based on year, it creates a new group for the boxplots as well,</span><span class="ch">\n</span><span class="st">and there are now two for each categorical.  This may not be what you want.&quot;</span>)</span></code></pre></div>
<p><img src="bookclub-ggplot2_01_files/figure-html/04-overriding-2.png" width="672" /></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="from-the-ggplot2-book.html#cb75-1"></a><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(drv, hwy, <span class="dt">color =</span> <span class="kw">factor</span>(year))) <span class="op">+</span></span>
<span id="cb75-2"><a href="from-the-ggplot2-book.html#cb75-2"></a><span class="kw">geom_jitter</span>() <span class="op">+</span></span>
<span id="cb75-3"><a href="from-the-ggplot2-book.html#cb75-3"></a><span class="kw">stat_boxplot</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="kw">aes</span>(<span class="dt">group =</span> drv)) <span class="op">+</span></span>
<span id="cb75-4"><a href="from-the-ggplot2-book.html#cb75-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;we override the default or earlier grouping by adding</span><span class="ch">\n</span><span class="st">a group -- inside the aes -- on the layer where we want it&quot;</span>)</span></code></pre></div>
<p><img src="bookclub-ggplot2_01_files/figure-html/04-overriding-3.png" width="672" /></p>
</div>
<div id="a-couple-of-exercises" class="section level3">
<h3><span class="header-section-number">4.4.4</span> A couple of exercises</h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="from-the-ggplot2-book.html#cb76-1"></a>mpg <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 11
##   manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class 
##   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compa…
## 2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p     compa…</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="from-the-ggplot2-book.html#cb78-1"></a><span class="co">#Draw a boxplot of hwy for each value of cyl, without turning cyl into a factor. What extra aesthetic do you need to set?</span></span>
<span id="cb78-2"><a href="from-the-ggplot2-book.html#cb78-2"></a></span>
<span id="cb78-3"><a href="from-the-ggplot2-book.html#cb78-3"></a><span class="co"># Wrong... but cyl is an integer data type -- are integers considered continuous?</span></span>
<span id="cb78-4"><a href="from-the-ggplot2-book.html#cb78-4"></a><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(cyl, hwy)) <span class="op">+</span></span>
<span id="cb78-5"><a href="from-the-ggplot2-book.html#cb78-5"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<pre><code>## Warning: Continuous x aesthetic -- did you forget aes(group=...)?</code></pre>
<p><img src="bookclub-ggplot2_01_files/figure-html/04-exercises-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="from-the-ggplot2-book.html#cb80-1"></a><span class="co"># Right</span></span>
<span id="cb80-2"><a href="from-the-ggplot2-book.html#cb80-2"></a><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(cyl, hwy, <span class="dt">group =</span> <span class="kw">as.factor</span>(cyl))) <span class="op">+</span></span>
<span id="cb80-3"><a href="from-the-ggplot2-book.html#cb80-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="bookclub-ggplot2_01_files/figure-html/04-exercises-1-2.png" width="672" /></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="from-the-ggplot2-book.html#cb81-1"></a><span class="co">#Modify the following plot so that you get one boxplot per integer value of displ.</span></span>
<span id="cb81-2"><a href="from-the-ggplot2-book.html#cb81-2"></a></span>
<span id="cb81-3"><a href="from-the-ggplot2-book.html#cb81-3"></a><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(displ, cty)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb81-4"><a href="from-the-ggplot2-book.html#cb81-4"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<pre><code>## Warning: Continuous x aesthetic -- did you forget aes(group=...)?</code></pre>
<p><img src="bookclub-ggplot2_01_files/figure-html/04-exercises-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="from-the-ggplot2-book.html#cb83-1"></a><span class="co"># probably better ways to do this, especially ways to make the boxplot line up with the x-axis</span></span>
<span id="cb83-2"><a href="from-the-ggplot2-book.html#cb83-2"></a><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">ceiling</span>(displ), cty, <span class="dt">group =</span> <span class="kw">ceiling</span>(displ))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb83-3"><a href="from-the-ggplot2-book.html#cb83-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="bookclub-ggplot2_01_files/figure-html/04-exercises-2-2.png" width="672" /></p>
</div>
<div id="matching-aesthetics-to-graphic-objects" class="section level3">
<h3><span class="header-section-number">4.4.5</span> Matching Aesthetics to Graphic Objects</h3>
<p>(Not covered in the preso)</p>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="quick-intuition-on-collective-geoms.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistical-summaries.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/r4ds/bookclub-ggplot2/edit/main/04-collective_geoms.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
